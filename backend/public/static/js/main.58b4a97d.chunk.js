(this["webpackJsonpsing-me-a-song"]=this["webpackJsonpsing-me-a-song"]||[]).push([[0],{707:function(e,t,n){e.exports=n(731)},712:function(e,t,n){},713:function(e,t,n){},731:function(e,t,n){"use strict";n.r(t);var a,r=n(8),o=n.n(r),c=n(59),i=n.n(c),s=(n(712),n(713),n(37)),l=n(14),u=n(60),m=(n(74),n(25)),d=n(66),f=n(7),p={apiGateway:{URL:"/api"}},g=Object(f.a)({},p).apiGateway.URL;!function(e){e[e.SELECTION=0]="SELECTION",e[e.LOADING=1]="LOADING",e[e.PLAYING=2]="PLAYING"}(a||(a={}));var w={songStage:a.SELECTION,topic:null,words:null},v=Object(d.b)({name:"song",initialState:w,reducers:{selectTopic:function(e,t){e.songStage=a.LOADING,e.topic=t.payload},receiveSong:function(e,t){e.songStage=a.PLAYING,e.topic=t.payload.topic,e.words=t.payload.words},restart:function(e){e.songStage=a.SELECTION,e.topic=null,e.words=null}}}),E=v.actions.restart,h=v.actions,b=h.receiveSong,N=h.selectTopic,O=function(e){var t;return null===(t=e.song.words)||void 0===t?void 0:t.map((function(e){var t=e.word,n=e.sound;return{word:t,sound:Uint8Array.from(atob(n),(function(e){return e.charCodeAt(0)})).buffer}}))},S=function(e){return e.song.songStage},y=v.reducer;function I(){var e=Object(r.useState)(""),t=Object(l.a)(e,2),n=t[0],a=t[1],c=Object(s.b)();function i(){m.h(),c(function(e){return function(t){t(N(e));var n=new URLSearchParams;n.append("topic",e),fetch("".concat(g,"/vocalTrack?").concat(n.toString())).then((function(e){return e.json()})).then((function(e){t(b({topic:e.topic,words:e.words}))}))}}(n))}return o.a.createElement("div",{className:"col init"},o.a.createElement("form",{onSubmit:i},o.a.createElement("label",null,"Sing me a song about:",o.a.createElement("input",{className:"topicInput",type:"text",onChange:function(e){a(e.target.value)}})),o.a.createElement("div",null,o.a.createElement(u.AwesomeButton,{type:"primary",onPress:i},"Sing for me"))))}var A=n(6),L=n.n(A),k=n(9);function j(e){return new m.c({urls:{C4:e},release:1}).toDestination()}function G(){return(G=Object(k.a)(L.a.mark((function e(t){var n,a,r,o,c,i,s,l,u,d;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(new m.d).toDestination().triggerAttackRelease("C4","8n"),n=new m.b("https://tonejs.github.io/audio/berklee/gong_1.mp3").toDestination(),m.f().then((function(){n.start()})),e.next=6,Promise.all(t.map(function(){var e=Object(k.a)(L.a.mark((function e(t){var n;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.e().decodeAudioData(t.sound);case 2:return n=e.sent,e.abrupt("return",{sound:j(n),word:t.word,duration:n.duration});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:return a=e.sent,e.next=9,m.f();case 9:for(r=m.g(),o=Math.random,c=1,.01,60,i=0;i<a.length;i++)s=a[i].sound,l=a[i].duration,2,u=Math.floor(2*o()*2)-2,.1,d=.1*o()*2-.1,s.triggerAttackRelease([m.a(60+u).toFrequency()],l+d,r+c),c+=l+d+.01;case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e){var t=Object(s.b)();return Object(r.useEffect)((function(){!function(e){G.apply(this,arguments)}(e.words)})),o.a.createElement("div",{className:"col-md-4 offset-md-4"},o.a.createElement("img",{className:"playingIcon",src:"music_black.svg"}),o.a.createElement("div",{className:"controls"},o.a.createElement(u.AwesomeButton,{type:"primary",onPress:function(){t(E())}},"Start Over")))}n(728);var x=n(695),D=n.n(x);function P(){return o.a.createElement("div",{className:"col"},o.a.createElement("h1",null,"Invalid State"))}function T(){var e=Object(s.c)(S),t=Object(s.c)(O);switch(e){case a.SELECTION:return o.a.createElement("div",{className:"col"},o.a.createElement(I,null));case a.PLAYING:return null==t?P():o.a.createElement("div",{className:"col"},o.a.createElement(C,{words:t}));case a.LOADING:return o.a.createElement("div",{className:"loadingAnimation"},o.a.createElement(D.a,{active:!0,color:"black",type:"line-scale-party"}));default:return P()}}var R=function(){return o.a.createElement("div",{className:"App"},o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"row d-flex align-items-center min-vh-100"},o.a.createElement(T,null))),o.a.createElement("footer",null,o.a.createElement("div",{className:"attribution"},"Icons made by ",o.a.createElement("a",{href:"http://www.freepik.com/",title:"Freepik"},"Freepik")," from ",o.a.createElement("a",{href:"https://www.flaticon.com/",title:"Flaticon"},"www.flaticon.com"))))},B=Object(d.a)({reducer:{song:y}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(730);i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(s.a,{store:B},o.a.createElement(R,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[707,1,2]]]);
//# sourceMappingURL=main.58b4a97d.chunk.js.map