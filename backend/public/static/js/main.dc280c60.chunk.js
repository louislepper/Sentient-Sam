(this["webpackJsonpsing-me-a-song"]=this["webpackJsonpsing-me-a-song"]||[]).push([[0],{706:function(e,t,n){e.exports=n(731)},711:function(e,t,n){},712:function(e,t,n){},731:function(e,t,n){"use strict";n.r(t);var a,r=n(8),o=n.n(r),c=n(59),i=n.n(c),s=(n(711),n(712),n(43)),l=n(14),u=n(544),m=(n(718),n(65)),f=n(7),d={apiGateway:{URL:"/api"}},p=Object(f.a)({},d).apiGateway.URL;!function(e){e[e.SELECTION=0]="SELECTION",e[e.LOADING=1]="LOADING",e[e.PLAYING=2]="PLAYING"}(a||(a={}));var g={songStage:a.SELECTION,topic:null,words:null},w=Object(m.b)({name:"song",initialState:g,reducers:{selectTopic:function(e,t){e.songStage=a.LOADING,e.topic=t.payload},receiveSong:function(e,t){e.songStage=a.PLAYING,e.topic=t.payload.topic,e.words=t.payload.words},restart:function(e){e.songStage=a.SELECTION,e.topic=null,e.words=null}}}),E=(w.actions.restart,w.actions),v=E.receiveSong,h=E.selectTopic,b=function(e){var t;return null===(t=e.song.words)||void 0===t?void 0:t.map((function(e){var t=e.word,n=e.sound;return{word:t,sound:Uint8Array.from(atob(n),(function(e){return e.charCodeAt(0)})).buffer}}))},N=function(e){return e.song.songStage},S=w.reducer;function O(){var e=Object(r.useState)(""),t=Object(l.a)(e,2),n=t[0],a=t[1],c=Object(s.b)();return o.a.createElement("div",{className:"col init"},o.a.createElement("form",null,o.a.createElement("label",null,"Sing me a song about:",o.a.createElement("input",{className:"topicInput",type:"text",onChange:function(e){a(e.target.value)}})),o.a.createElement("div",null,o.a.createElement(u.AwesomeButton,{type:"primary",onPress:function(){c(function(e){return function(t){t(h(e));var n=new URLSearchParams;n.append("topic",e),fetch("".concat(p,"/vocalTrack?").concat(n.toString())).then((function(e){return e.json()})).then((function(e){t(v({topic:e.topic,words:e.words}))}))}}(n))}},"Sing for me"))))}var y=n(6),I=n.n(y),A=n(9),L=n(31);function k(e){return function(){return new Promise((function(t){var n=new L.b(e).toDestination();n.onstop=t,L.f().then((function(){n.start()}))}))}}function j(e){return new L.c({urls:{C4:e},release:1}).toDestination()}function G(){return(G=Object(A.a)(I.a.mark((function e(t){var n,a,r,o,c,i,s,l,u;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(new L.d).toDestination().triggerAttackRelease("C4","8n"),n=new L.b("https://tonejs.github.io/audio/berklee/gong_1.mp3").toDestination(),L.f().then((function(){n.start()})),e.next=6,Promise.all(t.map((function(e){return L.e().decodeAudioData(e.sound)})));case 6:return a=e.sent,a.map((function(e){return k(e)})),r=a.map((function(e){return j(e)})),e.next=11,L.f();case 11:for(o=L.g(),c=1,.5,60,i=0;i<r.length;i++)s=r[i],l=Math.floor(10*Math.random())-5,u=.5*Math.random()-.25,s.triggerAttackRelease([L.a(60+l).toFrequency()],.5+u,o+c),c+=.5+u;case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e){return Object(r.useEffect)((function(){!function(e){G.apply(this,arguments)}(e.words)})),o.a.createElement("div",{className:"col-md-4 offset-md-4"},o.a.createElement("img",{src:"music_black.svg"}))}n(728);var D=n(694),P=n.n(D);function T(){return o.a.createElement("div",{className:"col"},o.a.createElement("h1",null,"Invalid State"))}function x(){var e=Object(s.c)(N),t=Object(s.c)(b);switch(e){case a.SELECTION:return o.a.createElement("div",{className:"col"},o.a.createElement(O,null));case a.PLAYING:return null==t?T():o.a.createElement("div",{className:"col"},o.a.createElement(C,{words:t}));case a.LOADING:return o.a.createElement("div",{className:"loadingAnimation"},o.a.createElement(P.a,{active:!0,color:"black",type:"line-scale-party"}));default:return T()}}var R=function(){return o.a.createElement("div",{className:"App"},o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"row d-flex align-items-center min-vh-100"},o.a.createElement(x,null))),o.a.createElement("footer",null,o.a.createElement("div",{className:"attribution"},"Icons made by ",o.a.createElement("a",{href:"http://www.freepik.com/",title:"Freepik"},"Freepik")," from ",o.a.createElement("a",{href:"https://www.flaticon.com/",title:"Flaticon"},"www.flaticon.com"))))},F=Object(m.a)({reducer:{song:S}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(730);i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(s.a,{store:F},o.a.createElement(R,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[706,1,2]]]);
//# sourceMappingURL=main.dc280c60.chunk.js.map